<% provide :title, @book.title %>
<% provide :icon, "icon/books.png"%>

<div class="site-section bg-light" id="main-content">
  <div class="container">
    <div class="row mb-5">
      <div class="col-md-12 text-center border-primary">
        <h1 class="font-weight-bold text-danger">
          <%= @book.title %>
        </h1>
      </div>
    </div>

    <% if can? Marker::AUTHORIZE_USER, Marker %>
      <div class="row bg-white col-md-12 m-0 mt-5 mb-5">
        <div class="col-md-3 mb-3 mt-3" id="marker-favorite">
          <%= marker_form @book.id, :favorite, current_user %>
        </div>
        <div class="col-md-3 mb-3 mt-3" id="marker-readed">
          <%= marker_form @book.id, :readed, current_user %>
        </div>
        <div class="col-md-3 mb-3 mt-3" id="marker-reading">
          <%= marker_form @book.id, :reading, current_user %>
        </div>
        <div class="col-md-3 mb-3 mt-3" id="marker-purchase_request">
          <%= marker_form @book.id, :purchase_request, current_user %>
        </div>
      </div>
    <% end %>

    <div class="row m-0">
      <div class="col-md-7">
        <div class="row bg-white pt-5 pb-3">

          <div class="col-md-4">
            <div class="mb-2">
              <div class="col-xs-4">
                <%= image_tag "img_2.jpg", class: "img-fluid" %>
              </div>
            </div>
          </div>

          <div class="col-md-8">
            <div class="border-warning pb-1 mb-3">
              <h4 class="font-weight-bold text-warning">
                <%= t ".book_information" %>
              </h4>
            </div>
            <div>
              <span><%= t ".author" %>:</span>
              <%= @book.author %>
            </div>
            <div>
              <span><%= t ".number_pages" %>:</span>
              <%= @book.number_pages %>
            </div>
            <div>
              <span><%= t ".publish_date" %>:</span>
              <%= l @book.publish_date, format: :datetime %>
            </div>
            <div>
              <span><%= t ".price" %>:</span>
              <%= @book.price %> VND
            </div>
            <hr>

            <div class="border-warning pb-1 mb-3">
              <h4 class="font-weight-bold text-warning">
                <%= t ".average_rating" %>
              </h4>
            </div>
            <div>
              <%= @book.reviews.count %> <%= t ".reviews" %>
            </div>
            <span class="average-review-rating"
              data-score="<%= @average_review %>">
            </span>
            <i>
              (<%= @average_review %> <%= t ".stars" %>)
            </i>
            <hr>

            <h4 class="font-weight-bold text-success">
              <%= t ".can_review" %>
            </h4>
            <div class="">
              <%= render "reviews/form" %>
            </div>
          </div>

        </div>

        <div class="row bg-white mt-5 pl-3 pt-5 pb-3 mb-5">
          <div class="border-warning pb-1 mb-3">
            <h4 class="font-weight-bold text-warning">
              <%= t ".description" %>
            </h4>
          </div>
          <div class="col-md-12 p-0">
            <%= @book.description.html_safe %>
          </div>
        </div>
      </div>

      <div class="col-md-5 pl-md-5 p-0">
        <div class="bg-white pt-5 pb-3 pl-3">
          <div class="border-warning pb-1 mb-3">
            <h4 class="font-weight-bold text-warning">
              <%= t ".community_reviews" %>
            </h4>
          </div>
          <div class="" id="list-reviews">
            <%= render @reviews %>
          </div>
          <div class="" id="kaminari-list-reviews">
            <%= paginate @reviews %>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
